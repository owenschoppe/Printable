var DOCLIST_SCOPE="https://docs.google.com/feeds";var DOCLIST_FEED=DOCLIST_SCOPE+"/default/private/full/";var docs=[];var row=[];var cat=[];var refreshRate=localStorage.refreshRate||300;var pollIntervalMin=1000*refreshRate;var requests=[];var docName;var docKey;var blacklistedExtension=null;var SPREAD_SCOPE="https://spreadsheets.google.com/feeds";var FULL_SCOPE=DOCLIST_SCOPE+" "+SPREAD_SCOPE;var callbacks=[];var oauth=ChromeExOAuth.initBackgroundPage({request_url:"https://www.google.com/accounts/OAuthGetRequestToken",authorize_url:"https://www.google.com/accounts/OAuthAuthorizeToken",access_url:"https://www.google.com/accounts/OAuthGetAccessToken",consumer_key:"1034066493115.apps.googleusercontent.com",consumer_secret:"ZYDYGWh1g71m2-w1iA0-VxSC",scope:FULL_SCOPE,app_name:"Citable"});function getPageInfo(a){console.log("getPageInfo");callbacks=[];callbacks.push(a);chrome.tabs.executeScript(null,{file:"jquery-1.7.2.min.js"},function(){chrome.tabs.executeScript(null,{file:"content_script.js"})})}chrome.extension.onConnect.addListener(function(a){var b=a.sender.tab;a.onMessage.addListener(function(c){console.log("onMessage Listener ",c.values);console.log("tab.url ",b.url);docKey=b.url.split("=")[1].split("#")[0].split("&")[0];localStorage.defaultDocName=b.title;localStorage.defaultDoc=docKey;if(c.values==0&&c.message=="myCustomEvent"){console.log("Try printing");gdocs.printDocumentPage()}else{if(c.values==1&&c.message=="myCustomEvent"){console.log("Try exporting");gdocs.exportDocumentPage()}}})});chrome.extension.onRequestExternal.addListener(function(c,b,a){console.log("request: ",c,c.name);if(b.id==blacklistedExtension){return}else{if(c.printDoc){docKey=c.key;localStorage.defaultDoc=docKey;localStorage.defaultDocName=c.name;gdocs.printDocumentPage();a({success:true})}else{if(c.exportDoc){docKey=c.key;localStorage.defaultDoc=docKey;localStorage.defaultDocName=c.name;gdocs.exportDocumentPage();a({success:true})}}}console.log("docKey ",docKey)});function setIcon(b){if(b){var a={};if(b&&b.text!==undefined){a.text=b.text}if(b&&b.tabId){a.tabId=b.tabId}chrome.browserAction.setBadgeText(a)}}function clearPendingRequests(){for(var a=0,b;b=requests[a];++a){window.clearTimeout(b)}requests=[]}function logout(){docs=[];setIcon({text:""});oauth.clearTokens();clearPendingRequests()};